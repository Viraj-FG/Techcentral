import{j as e}from"./ui-vendor-CRu_cuPE.js";import{r as x}from"./react-vendor-DwZQO67Z.js";import{A as q}from"./AppShell-DVt8-4f8.js";import{C as j,d as y,a as z,b as I}from"./card-q-j3zA9P.js";import{aV as P,D as B,b7 as H,B as c,ar as O,e as G,f as L,g as M,L as i,I as g,b8 as R,o as v,G as W,T as U,q as r,s as _}from"./index-D4bhw5kJ.js";import{S as N,a as S,b as w,c as b,d as l}from"./select-BN0Wnciu.js";import{S as Y}from"./switch-_hpo76TP.js";import{S as J}from"./square-pen-UPLsKTmJ.js";import"./animation-vendor-C-lCNj7M.js";import"./scan-rfUsMt4r.js";import"./tabs-C9GQepe1.js";import"./UniversalShell-B176IQVx.js";import"./trending-down-D_vIl22O.js";import"./leaf-DXJ1a3o-.js";import"./chart-vendor-BDCxrQ3h.js";import"./supabase-vendor-BS1x--yE.js";const k=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],me=()=>{const{pets:m,petSchedules:C,refresh:p}=P(),[D,h]=x.useState(!1),[o,u]=x.useState(null),[a,n]=x.useState({pet_id:"",schedule_type:"feeding",time_of_day:"",days_of_week:[0,1,2,3,4,5,6],amount:"",notes:"",reminder_enabled:!0}),T=async()=>{if(!a.pet_id||!a.time_of_day){r.error("Please select a pet and time");return}try{if(o){const{error:s}=await _.from("pet_schedules").update({schedule_type:a.schedule_type,time_of_day:a.time_of_day,days_of_week:a.days_of_week,amount:a.amount||null,notes:a.notes||null,reminder_enabled:a.reminder_enabled}).eq("id",o.id);if(s)throw s;r.success("Schedule updated")}else{const{error:s}=await _.from("pet_schedules").insert({pet_id:a.pet_id,schedule_type:a.schedule_type,time_of_day:a.time_of_day,days_of_week:a.days_of_week,amount:a.amount||null,notes:a.notes||null,reminder_enabled:a.reminder_enabled});if(s)throw s;r.success("Schedule created")}h(!1),u(null),n({pet_id:"",schedule_type:"feeding",time_of_day:"",days_of_week:[0,1,2,3,4,5,6],amount:"",notes:"",reminder_enabled:!0}),p()}catch(s){console.error("Error saving schedule:",s),r.error("Failed to save schedule")}},A=async s=>{try{const{error:t}=await _.from("pet_schedules").delete().eq("id",s);if(t)throw t;r.success("Schedule deleted"),p()}catch(t){console.error("Error deleting schedule:",t),r.error("Failed to delete schedule")}},E=s=>{n(t=>({...t,days_of_week:t.days_of_week.includes(s)?t.days_of_week.filter(d=>d!==s):[...t.days_of_week,s].sort()}))},F=s=>{u(s),n({pet_id:s.pet_id,schedule_type:s.schedule_type,time_of_day:s.time_of_day,days_of_week:s.days_of_week,amount:s.amount||"",notes:s.notes||"",reminder_enabled:s.reminder_enabled}),h(!0)},f=m.reduce((s,t)=>(s[t.id]=C.filter(d=>d.pet_id===t.id),s),{});return e.jsx(q,{onScan:()=>{},children:e.jsxs("div",{className:"space-y-6 pb-24",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Feeding Schedule"}),e.jsxs(B,{open:D,onOpenChange:h,children:[e.jsx(H,{asChild:!0,children:e.jsxs(c,{onClick:()=>{u(null),n({pet_id:"",schedule_type:"feeding",time_of_day:"",days_of_week:[0,1,2,3,4,5,6],amount:"",notes:"",reminder_enabled:!0})},children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Add Schedule"]})}),e.jsxs(G,{className:"max-w-md",children:[e.jsx(L,{children:e.jsxs(M,{children:[o?"Edit":"Add"," Schedule"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Pet"}),e.jsxs(N,{value:a.pet_id,onValueChange:s=>n({...a,pet_id:s}),disabled:!!o,children:[e.jsx(S,{children:e.jsx(w,{placeholder:"Select pet"})}),e.jsx(b,{children:m.map(s=>e.jsx(l,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Type"}),e.jsxs(N,{value:a.schedule_type,onValueChange:s=>n({...a,schedule_type:s}),children:[e.jsx(S,{children:e.jsx(w,{})}),e.jsxs(b,{children:[e.jsx(l,{value:"feeding",children:"Feeding"}),e.jsx(l,{value:"medication",children:"Medication"}),e.jsx(l,{value:"grooming",children:"Grooming"}),e.jsx(l,{value:"exercise",children:"Exercise"}),e.jsx(l,{value:"vet",children:"Vet Visit"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Time"}),e.jsx(g,{type:"time",value:a.time_of_day,onChange:s=>n({...a,time_of_day:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Days of Week"}),e.jsx("div",{className:"flex gap-2",children:k.map((s,t)=>e.jsx(c,{type:"button",size:"sm",variant:a.days_of_week.includes(t)?"default":"outline",onClick:()=>E(t),children:s},t))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Amount (optional)"}),e.jsx(g,{value:a.amount,onChange:s=>n({...a,amount:s.target.value}),placeholder:"e.g., 1 cup, 2 tablets"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Notes (optional)"}),e.jsx(R,{value:a.notes,onChange:s=>n({...a,notes:s.target.value}),placeholder:"Additional notes..."})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Enable Reminders"}),e.jsx(Y,{checked:a.reminder_enabled,onCheckedChange:s=>n({...a,reminder_enabled:s})})]}),e.jsxs(c,{onClick:T,className:"w-full",children:[o?"Update":"Create"," Schedule"]})]})]})]})]}),m.length===0?e.jsx(j,{children:e.jsx(y,{className:"py-12 text-center text-muted-foreground",children:"No pets found. Add a pet first."})}):m.map(s=>{var t;return e.jsxs(j,{children:[e.jsx(z,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[s.name,e.jsx(v,{variant:"secondary",children:s.species})]})}),e.jsx(y,{children:((t=f[s.id])==null?void 0:t.length)>0?e.jsx("div",{className:"space-y-3",children:f[s.id].map(d=>e.jsxs("div",{className:"flex items-start justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(W,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:d.time_of_day}),e.jsx(v,{variant:"outline",className:"capitalize",children:d.schedule_type})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:d.days_of_week.map(V=>k[V]).join(", ")}),d.amount&&e.jsxs("div",{className:"text-sm mt-1",children:["Amount: ",d.amount]}),d.notes&&e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:d.notes})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{size:"icon",variant:"ghost",onClick:()=>F(d),children:e.jsx(J,{className:"w-4 h-4"})}),e.jsx(c,{size:"icon",variant:"ghost",onClick:()=>A(d.id),children:e.jsx(U,{className:"w-4 h-4"})})]})]},d.id))}):e.jsxs("p",{className:"text-muted-foreground text-center py-4",children:["No schedules configured for ",s.name]})})]},s.id)})]})})};export{me as default};
