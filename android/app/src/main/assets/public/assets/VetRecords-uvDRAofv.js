import{j as e}from"./ui-vendor-CRu_cuPE.js";import{r as _}from"./react-vendor-DwZQO67Z.js";import{A as E}from"./AppShell-DVt8-4f8.js";import{C as N,d as C,a as F,b as H}from"./card-q-j3zA9P.js";import{d as y,aV as I,aA as h,D as P,b7 as z,B as p,ar as L,e as B,f as O,g as U,L as c,I as r,b8 as u,o as b,T as G,q as d,s as j}from"./index-D4bhw5kJ.js";import{S as D,a as w,b as k,c as S,d as l}from"./select-BN0Wnciu.js";import{S as J}from"./square-pen-UPLsKTmJ.js";import{C as K}from"./UniversalShell-B176IQVx.js";import"./animation-vendor-C-lCNj7M.js";import"./scan-rfUsMt4r.js";import"./tabs-C9GQepe1.js";import"./trending-down-D_vIl22O.js";import"./leaf-DXJ1a3o-.js";import"./chart-vendor-BDCxrQ3h.js";import"./supabase-vendor-BS1x--yE.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=y("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=y("Stethoscope",[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=y("Syringe",[["path",{d:"m18 2 4 4",key:"22kx64"}],["path",{d:"m17 7 3-3",key:"1w1zoj"}],["path",{d:"M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5",key:"1exhtz"}],["path",{d:"m9 11 4 4",key:"rovt3i"}],["path",{d:"m5 19-3 3",key:"59f2uf"}],["path",{d:"m14 4 6 6",key:"yqp9t2"}]]),he=()=>{const{pets:m,petVetRecords:M,refresh:g}=I(),[R,x]=_.useState(!1),[o,v]=_.useState(null),[t,i]=_.useState({pet_id:"",record_type:"visit",visit_date:h(new Date,"yyyy-MM-dd"),clinic_name:"",veterinarian_name:"",diagnosis:"",treatment:"",medication_prescribed:"",cost:"",next_visit_date:"",vaccination_type:"",vaccination_due_date:"",notes:""}),V=async()=>{if(!t.pet_id||!t.visit_date){d.error("Please select a pet and visit date");return}try{const a={pet_id:t.pet_id,record_type:t.record_type,visit_date:t.visit_date,clinic_name:t.clinic_name||null,veterinarian_name:t.veterinarian_name||null,diagnosis:t.diagnosis||null,treatment:t.treatment||null,medication_prescribed:t.medication_prescribed||null,cost:t.cost?parseFloat(t.cost):null,next_visit_date:t.next_visit_date||null,vaccination_type:t.vaccination_type||null,vaccination_due_date:t.vaccination_due_date||null,notes:t.notes||null};if(o){const{error:n}=await j.from("pet_vet_records").update(a).eq("id",o.id);if(n)throw n;d.success("Record updated")}else{const{error:n}=await j.from("pet_vet_records").insert(a);if(n)throw n;d.success("Record created")}x(!1),v(null),i({pet_id:"",record_type:"visit",visit_date:h(new Date,"yyyy-MM-dd"),clinic_name:"",veterinarian_name:"",diagnosis:"",treatment:"",medication_prescribed:"",cost:"",next_visit_date:"",vaccination_type:"",vaccination_due_date:"",notes:""}),g()}catch(a){console.error("Error saving record:",a),d.error("Failed to save record")}},T=async a=>{try{const{error:n}=await j.from("pet_vet_records").delete().eq("id",a);if(n)throw n;d.success("Record deleted"),g()}catch(n){console.error("Error deleting record:",n),d.error("Failed to delete record")}},q=a=>{v(a),i({pet_id:a.pet_id,record_type:a.record_type,visit_date:a.visit_date,clinic_name:a.clinic_name||"",veterinarian_name:a.veterinarian_name||"",diagnosis:a.diagnosis||"",treatment:a.treatment||"",medication_prescribed:a.medication_prescribed||"",cost:a.cost?a.cost.toString():"",next_visit_date:a.next_visit_date||"",vaccination_type:a.vaccination_type||"",vaccination_due_date:a.vaccination_due_date||"",notes:a.notes||""}),x(!0)},f=m.reduce((a,n)=>(a[n.id]=M.filter(s=>s.pet_id===n.id),a),{}),A=a=>{switch(a){case"vaccination":return e.jsx(X,{className:"w-4 h-4"});case"checkup":return e.jsx(W,{className:"w-4 h-4"});default:return e.jsx(K,{className:"w-4 h-4"})}};return e.jsx(E,{onScan:()=>{},children:e.jsxs("div",{className:"space-y-6 pb-24",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Vet Records"}),e.jsxs(P,{open:R,onOpenChange:x,children:[e.jsx(z,{asChild:!0,children:e.jsxs(p,{onClick:()=>{v(null),i({pet_id:"",record_type:"visit",visit_date:h(new Date,"yyyy-MM-dd"),clinic_name:"",veterinarian_name:"",diagnosis:"",treatment:"",medication_prescribed:"",cost:"",next_visit_date:"",vaccination_type:"",vaccination_due_date:"",notes:""})},children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Add Record"]})}),e.jsxs(B,{className:"max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsx(O,{children:e.jsxs(U,{children:[o?"Edit":"Add"," Vet Record"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Pet"}),e.jsxs(D,{value:t.pet_id,onValueChange:a=>i({...t,pet_id:a}),disabled:!!o,children:[e.jsx(w,{children:e.jsx(k,{placeholder:"Select pet"})}),e.jsx(S,{children:m.map(a=>e.jsx(l,{value:a.id,children:a.name},a.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Record Type"}),e.jsxs(D,{value:t.record_type,onValueChange:a=>i({...t,record_type:a}),children:[e.jsx(w,{children:e.jsx(k,{})}),e.jsxs(S,{children:[e.jsx(l,{value:"visit",children:"Visit"}),e.jsx(l,{value:"vaccination",children:"Vaccination"}),e.jsx(l,{value:"medication",children:"Medication"}),e.jsx(l,{value:"procedure",children:"Procedure"}),e.jsx(l,{value:"checkup",children:"Checkup"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Visit Date"}),e.jsx(r,{type:"date",value:t.visit_date,onChange:a=>i({...t,visit_date:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Clinic Name"}),e.jsx(r,{value:t.clinic_name,onChange:a=>i({...t,clinic_name:a.target.value}),placeholder:"Clinic name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Veterinarian"}),e.jsx(r,{value:t.veterinarian_name,onChange:a=>i({...t,veterinarian_name:a.target.value}),placeholder:"Dr. Name"})]}),t.record_type==="vaccination"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Vaccination Type"}),e.jsx(r,{value:t.vaccination_type,onChange:a=>i({...t,vaccination_type:a.target.value}),placeholder:"e.g., Rabies, Distemper"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Next Due Date"}),e.jsx(r,{type:"date",value:t.vaccination_due_date,onChange:a=>i({...t,vaccination_due_date:a.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Diagnosis"}),e.jsx(u,{value:t.diagnosis,onChange:a=>i({...t,diagnosis:a.target.value}),placeholder:"Diagnosis..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Treatment"}),e.jsx(u,{value:t.treatment,onChange:a=>i({...t,treatment:a.target.value}),placeholder:"Treatment provided..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Medication Prescribed"}),e.jsx(r,{value:t.medication_prescribed,onChange:a=>i({...t,medication_prescribed:a.target.value}),placeholder:"Medications"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Cost"}),e.jsx(r,{type:"number",step:"0.01",value:t.cost,onChange:a=>i({...t,cost:a.target.value}),placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Next Visit Date"}),e.jsx(r,{type:"date",value:t.next_visit_date,onChange:a=>i({...t,next_visit_date:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Notes"}),e.jsx(u,{value:t.notes,onChange:a=>i({...t,notes:a.target.value}),placeholder:"Additional notes..."})]}),e.jsxs(p,{onClick:V,className:"w-full",children:[o?"Update":"Create"," Record"]})]})]})]})]}),m.length===0?e.jsx(N,{children:e.jsx(C,{className:"py-12 text-center text-muted-foreground",children:"No pets found. Add a pet first."})}):m.map(a=>{var n;return e.jsxs(N,{children:[e.jsx(F,{children:e.jsxs(H,{className:"flex items-center gap-2",children:[a.name,e.jsx(b,{variant:"secondary",children:a.species})]})}),e.jsx(C,{children:((n=f[a.id])==null?void 0:n.length)>0?e.jsx("div",{className:"space-y-3",children:f[a.id].map(s=>e.jsxs("div",{className:"flex items-start justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[A(s.record_type),e.jsx("span",{className:"font-medium",children:h(new Date(s.visit_date),"MMM dd, yyyy")}),e.jsx(b,{variant:"outline",className:"capitalize",children:s.record_type})]}),s.clinic_name&&e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:s.clinic_name}),s.diagnosis&&e.jsxs("div",{className:"text-sm mb-1",children:[e.jsx("strong",{children:"Diagnosis:"})," ",s.diagnosis]}),s.treatment&&e.jsxs("div",{className:"text-sm mb-1",children:[e.jsx("strong",{children:"Treatment:"})," ",s.treatment]}),s.vaccination_type&&e.jsxs("div",{className:"text-sm mb-1",children:[e.jsx("strong",{children:"Vaccine:"})," ",s.vaccination_type]}),s.cost&&e.jsxs("div",{className:"text-sm flex items-center gap-1 text-muted-foreground",children:[e.jsx(Q,{className:"w-3 h-3"}),s.cost.toFixed(2)]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{size:"icon",variant:"ghost",onClick:()=>q(s),children:e.jsx(J,{className:"w-4 h-4"})}),e.jsx(p,{size:"icon",variant:"ghost",onClick:()=>T(s.id),children:e.jsx(G,{className:"w-4 h-4"})})]})]},s.id))}):e.jsxs("p",{className:"text-muted-foreground text-center py-4",children:["No vet records for ",a.name]})})]},a.id)})]})})};export{he as default};
