import{j as e}from"./ui-vendor-CRu_cuPE.js";import{u as k,r as l}from"./react-vendor-DwZQO67Z.js";import{A as w}from"./AppShell-DVt8-4f8.js";import{C as f,a as p,b as u,d as g}from"./card-q-j3zA9P.js";import{aX as v,I as T,B as j,w as A,s as c,q as B}from"./index-D4bhw5kJ.js";import{S as E}from"./scan-rfUsMt4r.js";import{C as I,a as X}from"./circle-x-CDVLy9TU.js";import"./animation-vendor-C-lCNj7M.js";import"./tabs-C9GQepe1.js";import"./UniversalShell-B176IQVx.js";import"./trending-down-D_vIl22O.js";import"./leaf-DXJ1a3o-.js";import"./chart-vendor-BDCxrQ3h.js";import"./supabase-vendor-BS1x--yE.js";const _=()=>{const y=k(),[o,N]=l.useState(""),[i,n]=l.useState(!1),[s,d]=l.useState(null),m=async()=>{var a,x;if(o.trim()){n(!0),d(null);try{const{data:{user:t}}=await c.auth.getUser();if(!t)return;const{data:r}=await c.from("pets").select("species, breed").eq("user_id",t.id),S=((a=r==null?void 0:r[0])==null?void 0:a.species)||"Dog",b=(x=r==null?void 0:r[0])==null?void 0:x.breed,{data:C,error:h}=await c.functions.invoke("check-pet-food-safety",{body:{foodItem:o,petType:S,breed:b}});if(h)throw h;d(C)}catch(t){console.error("Safety check failed:",t),B.error("Failed to check safety")}finally{n(!1)}}};return e.jsx(w,{onScan:()=>{},children:e.jsxs("div",{className:"space-y-6 pb-24",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Toxic Monitor"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(v,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(T,{placeholder:"Check a food (e.g. Grapes)",className:"pl-9",value:o,onChange:a=>N(a.target.value),onKeyDown:a=>a.key==="Enter"&&m()})]}),e.jsx(j,{onClick:m,disabled:i,children:i?"Checking...":"Check"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs(j,{variant:"outline",className:"h-24 flex flex-col gap-2 border-dashed",onClick:()=>y("/scanner?mode=food"),children:[e.jsx(E,{className:"h-8 w-8 text-primary"}),e.jsx("span",{children:"Scan Product Barcode/Label"})]})}),s&&e.jsxs(f,{className:`border-l-4 ${s.isSafe?"border-l-green-500 bg-green-500/10":"border-l-red-500 bg-red-500/10"}`,children:[e.jsx(p,{children:e.jsxs(u,{className:`flex items-center gap-2 ${s.isSafe?"text-green-600":"text-red-600"}`,children:[s.isSafe?e.jsx(I,{className:"h-5 w-5"}):e.jsx(X,{className:"h-5 w-5"}),s.isSafe?"Safe":"Toxic Warning"]})}),e.jsxs(g,{children:[e.jsx("p",{className:"font-medium text-lg",children:s.warning||"This item appears safe."}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:s.details})]})]}),!s&&e.jsxs(f,{className:"border-yellow-500/50 bg-yellow-500/10",children:[e.jsx(p,{children:e.jsxs(u,{className:"flex items-center gap-2 text-yellow-500",children:[e.jsx(A,{className:"h-5 w-5"}),"Safety Alert System"]})}),e.jsx(g,{children:e.jsx("p",{className:"text-sm",children:"Scan any product to instantly check if it's safe for your pets. We monitor for common toxins like Xylitol, Chocolate, Grapes, and more."})})]})]})})};export{_ as default};
