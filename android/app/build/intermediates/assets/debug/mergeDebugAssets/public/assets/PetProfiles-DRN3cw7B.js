import{j as e,ag as w,ah as C,ai as S}from"./ui-vendor-CRu_cuPE.js";import{r as c}from"./react-vendor-DwZQO67Z.js";import{A as E}from"./AppShell-DVt8-4f8.js";import{C as _,d as N,a as F,b as T}from"./card-q-j3zA9P.js";import{j as b,aV as B,D as I,b7 as R,B as x,ar as y,e as q,f as O,g as H,L as n,I as h,b8 as U,b9 as V,o as v,T as L,q as o,s as j}from"./index-D4bhw5kJ.js";import{S as Y,a as $,b as G,c as J,d as g}from"./select-BN0Wnciu.js";import{S as K}from"./switch-_hpo76TP.js";import{S as M}from"./square-pen-UPLsKTmJ.js";import"./animation-vendor-C-lCNj7M.js";import"./scan-rfUsMt4r.js";import"./tabs-C9GQepe1.js";import"./UniversalShell-B176IQVx.js";import"./trending-down-D_vIl22O.js";import"./leaf-DXJ1a3o-.js";import"./chart-vendor-BDCxrQ3h.js";import"./supabase-vendor-BS1x--yE.js";const P=c.forwardRef(({className:l,...i},d)=>e.jsx(w,{ref:d,className:b("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",l),...i}));P.displayName=w.displayName;const Q=c.forwardRef(({className:l,...i},d)=>e.jsx(S,{ref:d,className:b("aspect-square h-full w-full",l),...i}));Q.displayName=S.displayName;const z=c.forwardRef(({className:l,...i},d)=>e.jsx(C,{ref:d,className:b("flex h-full w-full items-center justify-center rounded-full bg-muted",l),...i}));z.displayName=C.displayName;const he=()=>{const{pets:l,refresh:i}=B(),[d,u]=c.useState(!1),[f,p]=c.useState(null),[a,r]=c.useState({name:"",species:"dog",breed:"",age:"",food_brand:"",daily_serving_size:"",toxic_flags_enabled:!0,notes:""}),D=async()=>{if(!a.name||!a.species){o.error("Please enter pet name and species");return}try{const{data:{user:s}}=await j.auth.getUser();if(!s)throw new Error("Not authenticated");const t={name:a.name,species:a.species,breed:a.breed||null,age:a.age?parseInt(a.age):null,food_brand:a.food_brand||null,daily_serving_size:a.daily_serving_size?parseFloat(a.daily_serving_size):null,toxic_flags_enabled:a.toxic_flags_enabled,notes:a.notes||null};if(f){const{error:m}=await j.from("pets").update(t).eq("id",f.id);if(m)throw m;o.success("Pet profile updated")}else{const{error:m}=await j.from("pets").insert({...t,user_id:s.id});if(m)throw m;o.success("Pet profile created")}u(!1),p(null),r({name:"",species:"dog",breed:"",age:"",food_brand:"",daily_serving_size:"",toxic_flags_enabled:!0,notes:""}),i()}catch(s){console.error("Error saving pet:",s),o.error("Failed to save pet profile")}},A=async s=>{try{const{error:t}=await j.from("pets").delete().eq("id",s);if(t)throw t;o.success("Pet profile deleted"),i()}catch(t){console.error("Error deleting pet:",t),o.error("Failed to delete pet")}},k=s=>{p(s),r({name:s.name,species:s.species,breed:s.breed||"",age:s.age?s.age.toString():"",food_brand:s.food_brand||"",daily_serving_size:s.daily_serving_size?s.daily_serving_size.toString():"",toxic_flags_enabled:s.toxic_flags_enabled,notes:s.notes||""}),u(!0)};return e.jsx(E,{onScan:()=>{},children:e.jsxs("div",{className:"space-y-6 pb-24",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Pet Profiles"}),e.jsxs(I,{open:d,onOpenChange:u,children:[e.jsx(R,{asChild:!0,children:e.jsxs(x,{onClick:()=>{p(null),r({name:"",species:"dog",breed:"",age:"",food_brand:"",daily_serving_size:"",toxic_flags_enabled:!0,notes:""})},children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Add Pet"]})}),e.jsxs(q,{className:"max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsx(O,{children:e.jsxs(H,{children:[f?"Edit":"Add"," Pet Profile"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Name *"}),e.jsx(h,{value:a.name,onChange:s=>r({...a,name:s.target.value}),placeholder:"Pet name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Species *"}),e.jsxs(Y,{value:a.species,onValueChange:s=>r({...a,species:s}),children:[e.jsx($,{children:e.jsx(G,{})}),e.jsxs(J,{children:[e.jsx(g,{value:"dog",children:"Dog"}),e.jsx(g,{value:"cat",children:"Cat"}),e.jsx(g,{value:"bird",children:"Bird"}),e.jsx(g,{value:"rabbit",children:"Rabbit"}),e.jsx(g,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Breed"}),e.jsx(h,{value:a.breed,onChange:s=>r({...a,breed:s.target.value}),placeholder:"Breed"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Age (years)"}),e.jsx(h,{type:"number",value:a.age,onChange:s=>r({...a,age:s.target.value}),placeholder:"Age"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Food Brand"}),e.jsx(h,{value:a.food_brand,onChange:s=>r({...a,food_brand:s.target.value}),placeholder:"Preferred food brand"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Daily Serving Size (cups/grams)"}),e.jsx(h,{type:"number",step:"0.1",value:a.daily_serving_size,onChange:s=>r({...a,daily_serving_size:s.target.value}),placeholder:"Serving size"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{children:"Enable Toxic Food Alerts"}),e.jsx(K,{checked:a.toxic_flags_enabled,onCheckedChange:s=>r({...a,toxic_flags_enabled:s})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Notes"}),e.jsx(U,{value:a.notes,onChange:s=>r({...a,notes:s.target.value}),placeholder:"Special notes, allergies, preferences...",rows:3})]}),e.jsxs(x,{onClick:D,className:"w-full",children:[f?"Update":"Create"," Profile"]})]})]})]})]}),l.length===0?e.jsx(_,{children:e.jsxs(N,{className:"py-12 text-center",children:[e.jsx(V,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No pets added yet"}),e.jsxs(x,{onClick:()=>u(!0),children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Add Your First Pet"]})]})}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:l.map(s=>e.jsxs(_,{children:[e.jsx(F,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"h-12 w-12",children:e.jsx(z,{className:"bg-primary/10 text-primary",children:s.name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx(T,{className:"text-xl",children:s.name}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx(v,{variant:"secondary",className:"capitalize",children:s.species}),s.age&&e.jsxs(v,{variant:"outline",children:[s.age," yrs"]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{size:"icon",variant:"ghost",onClick:()=>k(s),children:e.jsx(M,{className:"w-4 h-4"})}),e.jsx(x,{size:"icon",variant:"ghost",onClick:()=>A(s.id),children:e.jsx(L,{className:"w-4 h-4"})})]})]})}),e.jsxs(N,{className:"space-y-3",children:[s.breed&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Breed:"})," ",s.breed]}),s.food_brand&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Food:"})," ",s.food_brand,s.daily_serving_size&&` (${s.daily_serving_size} per day)`]}),s.notes&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Notes:"})," ",s.notes]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Toxic Alerts:"}),e.jsx(v,{variant:s.toxic_flags_enabled?"default":"secondary",children:s.toxic_flags_enabled?"Enabled":"Disabled"})]})]})]},s.id))})]})})};export{he as default};
