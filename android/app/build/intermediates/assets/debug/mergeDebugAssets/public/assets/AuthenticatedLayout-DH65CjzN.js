const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/VoiceAssistantContext-C3VUdkqs.js","assets/index-D4bhw5kJ.js","assets/ui-vendor-CRu_cuPE.js","assets/react-vendor-DwZQO67Z.js","assets/chart-vendor-BDCxrQ3h.js","assets/supabase-vendor-BS1x--yE.js","assets/animation-vendor-C-lCNj7M.js","assets/index-CSksSmjt.css"])))=>i.map(i=>d[i]);
import{B as x,F as k,am as S,I as D,bf as C,s as N,u as A,V as v,X as T,p as _,bg as z,a4 as I,i as L,bh as M}from"./index-D4bhw5kJ.js";import{j as e}from"./ui-vendor-CRu_cuPE.js";import{r as a,O as P}from"./react-vendor-DwZQO67Z.js";import{u as E,E as V}from"./VoiceAssistantContext-C3VUdkqs.js";import{B as j}from"./bot-BSc2axEU.js";import{U as O}from"./user-DLA5oS07.js";import{m as i,A as $}from"./animation-vendor-C-lCNj7M.js";import"./chart-vendor-BDCxrQ3h.js";import"./supabase-vendor-BS1x--yE.js";const B=({onClose:n})=>{const[r,c]=a.useState([{id:"1",role:"assistant",content:'Hello! I can help you plan your meals. Try saying "Plan my week" or "Add Pizza to Friday dinner".',timestamp:new Date}]),[l,u]=a.useState(""),[p,f]=a.useState(!1),d=a.useRef(null);a.useEffect(()=>{d.current&&(d.current.scrollTop=d.current.scrollHeight)},[r]);const w=async()=>{if(!l.trim())return;const t={id:Date.now().toString(),role:"user",content:l,timestamp:new Date};c(o=>[...o,t]),u(""),f(!0);try{const o=t.content.toLowerCase();let m="I'm not sure how to do that yet. Try 'Plan my week' or 'Add [recipe] to [day]'.";if(o.includes("plan")){m="Generating your meal plan... this may take a moment.",c(y=>[...y,{id:Date.now().toString(),role:"assistant",content:m,timestamp:new Date}]);const s=new Date;s.setDate(s.getDate()+(8-s.getDay())%7);const{data:g,error:h}=await N.functions.invoke("generate-meal-plan",{body:{week_start_date:s.toISOString().split("T")[0],preferences:{custom_instructions:t.content}}});if(h)throw h;m=`Done! Created ${g.meals_created} meals and added ${g.shopping_items_added} items to your shopping list.`}else if(o.includes("add")&&o.includes("to")){const s=t.content.match(/add (.*) to (.*)/i);if(s&&s.length===3){const g=s[1].trim(),h=s[2].trim().split(" "),y=h[0],R=h.length>1?h[1]:"dinner",{data:b}=await N.from("recipes").select("id, name").ilike("name",`%${g}%`).limit(1);b&&b.length>0}}c(s=>[...s,{id:(Date.now()+1).toString(),role:"assistant",content:m,timestamp:new Date}])}catch(o){console.error("Agent error:",o),c(m=>[...m,{id:Date.now().toString(),role:"assistant",content:"Sorry, something went wrong. Please try again.",timestamp:new Date}])}finally{f(!1)}};return e.jsxs("div",{className:"flex flex-col h-full bg-background/95 backdrop-blur-xl rounded-2xl overflow-hidden border border-white/10",children:[e.jsxs("div",{className:"p-4 border-b border-white/10 flex items-center justify-between bg-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"font-medium text-foreground",children:"Meal Assistant"})]}),e.jsxs(x,{variant:"ghost",size:"icon",onClick:n,className:"h-8 w-8",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-x w-4 h-4",children:[e.jsx("path",{d:"M18 6 6 18"}),e.jsx("path",{d:"m6 6 12 12"})]})]})]}),e.jsx(k,{className:"flex-1 p-4",ref:d,children:e.jsxs("div",{className:"space-y-4",children:[r.map(t=>e.jsxs("div",{className:`flex gap-3 ${t.role==="user"?"flex-row-reverse":""}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center shrink-0 ${t.role==="user"?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:t.role==="user"?e.jsx(O,{className:"w-4 h-4"}):e.jsx(j,{className:"w-4 h-4"})}),e.jsx("div",{className:`rounded-2xl px-4 py-2 max-w-[80%] ${t.role==="user"?"bg-primary text-primary-foreground rounded-tr-none":"bg-muted text-foreground rounded-tl-none"}`,children:e.jsx("p",{className:"text-sm",children:t.content})})]},t.id)),p&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-muted flex items-center justify-center shrink-0",children:e.jsx(j,{className:"w-4 h-4 text-muted-foreground"})}),e.jsx("div",{className:"bg-muted rounded-2xl rounded-tl-none px-4 py-2",children:e.jsx(S,{className:"w-4 h-4 animate-spin text-muted-foreground"})})]})]})}),e.jsx("div",{className:"p-4 border-t border-white/10 bg-white/5",children:e.jsxs("form",{onSubmit:t=>{t.preventDefault(),w()},className:"flex gap-2",children:[e.jsx(D,{value:l,onChange:t=>u(t.target.value),placeholder:"Type a command...",className:"bg-background/50 border-white/10 focus-visible:ring-primary"}),e.jsx(x,{type:"submit",size:"icon",disabled:p||!l.trim(),children:e.jsx(C,{className:"w-4 h-4"})})]})})]})},F=()=>{const[n,r]=a.useState(!1),[c,l]=a.useState(!1),{startConversation:u}=E(),{openModal:p}=A(),f=()=>{r(!1),u()},d=()=>{r(!1),p("camera")},w=()=>{l(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(i.button,{className:"fixed bottom-6 right-6 z-40 rounded-full shadow-lg hover:shadow-xl transition-shadow",whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>r(!0),children:e.jsx(v,{className:"w-14 h-14"})}),e.jsx($,{children:n&&e.jsx(i.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-black/95 backdrop-blur-xl p-6",children:c?e.jsx("div",{className:"w-full max-w-md h-[600px]",children:e.jsx(B,{onClose:()=>l(!1)})}):e.jsxs(e.Fragment,{children:[e.jsx(x,{variant:"ghost",size:"icon",className:"absolute top-6 right-6 text-white/70 hover:text-white hover:bg-white/10 rounded-full",onClick:()=>r(!1),children:e.jsx(T,{className:"w-6 h-6"})}),e.jsxs(i.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"absolute top-12 flex items-center gap-2 text-white/60 bg-white/5 px-4 py-2 rounded-full backdrop-blur-md",children:[e.jsx(V,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium tracking-wide",children:"your conscious"})]}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center w-full max-w-md text-center space-y-6",children:[e.jsxs(i.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2},children:[e.jsx("p",{className:"text-white/80 text-lg font-light",children:"hope your day is going great!"}),e.jsxs("h2",{className:"text-4xl font-medium text-white mt-2 leading-tight",children:["how can I help you",e.jsx("br",{}),"today?"]})]}),e.jsx(i.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3,type:"spring"},className:"absolute top-1/2 left-8 -translate-y-1/2",children:e.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center backdrop-blur-md",children:e.jsx(_,{className:"w-5 h-5 text-white"})})})]}),e.jsxs(i.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},className:"mb-12 flex items-center justify-center gap-8 w-full max-w-sm",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(x,{variant:"ghost",size:"icon",className:"w-16 h-16 rounded-full bg-white/10 hover:bg-white/20 text-white backdrop-blur-md border border-white/5 transition-all duration-300",onClick:w,children:e.jsx(z,{className:"w-6 h-6"})}),e.jsx("span",{className:"text-white/50 text-xs font-medium tracking-wider uppercase",children:"type"})]}),e.jsx("div",{className:"flex flex-col items-center gap-4 -mt-8",children:e.jsxs(i.button,{className:"relative group",whileHover:{scale:1.1},whileTap:{scale:.95},onClick:d,children:[e.jsx("div",{className:"absolute inset-0 bg-white/20 rounded-full blur-xl group-hover:bg-white/30 transition-colors"}),e.jsx(v,{className:"w-24 h-24"}),e.jsx("div",{className:"absolute bottom-0 right-0 bg-white text-black rounded-full p-1.5 shadow-lg",children:e.jsx("div",{className:"w-4 h-4 flex items-center justify-center",children:e.jsx("span",{className:"text-lg leading-none font-bold",children:"+"})})})]})}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(x,{variant:"ghost",size:"icon",className:"w-16 h-16 rounded-full bg-white/10 hover:bg-white/20 text-white backdrop-blur-md border border-white/5 transition-all duration-300",onClick:f,children:e.jsx(I,{className:"w-6 h-6"})}),e.jsx("span",{className:"text-white/50 text-xs font-medium tracking-wider uppercase",children:"speak"})]})]})]})})})]})},H=a.lazy(()=>M(()=>import("./VoiceAssistantContext-C3VUdkqs.js").then(n=>n.V),__vite__mapDeps([0,1,2,3,4,5,6,7])).then(n=>({default:n.VoiceAssistantProvider}))),Z=()=>e.jsx(a.Suspense,{fallback:e.jsx(i.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx(L,{size:"lg"})}),children:e.jsxs(H,{children:[e.jsx(P,{}),e.jsx(F,{})]})});export{Z as default};
