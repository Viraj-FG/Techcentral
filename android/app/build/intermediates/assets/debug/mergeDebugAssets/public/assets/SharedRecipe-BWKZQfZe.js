import{j as e}from"./ui-vendor-CRu_cuPE.js";import{k as N,u as b,r as l}from"./react-vendor-DwZQO67Z.js";import{s as x,q as v,O as o,B as d,o as i,j as y,G as w}from"./index-D4bhw5kJ.js";import{P as m}from"./PublicShell-DUMeAuyn.js";import{A as k}from"./arrow-left-CQcT7sCo.js";import{T as A}from"./trending-up-0sWaYDAK.js";import{U as _}from"./users-DudXFJtM.js";import"./chart-vendor-BDCxrQ3h.js";import"./supabase-vendor-BS1x--yE.js";import"./animation-vendor-C-lCNj7M.js";function G(){const{shareToken:c}=N(),n=b(),[r,h]=l.useState(null),[u,p]=l.useState(!0);l.useEffect(()=>{c&&f()},[c]);const f=async()=>{try{const{data:s,error:a}=await x.from("recipes").select("*").eq("share_token",c).eq("is_public",!0).single();if(a)throw a;s&&(h(s),await x.from("recipes").update({view_count:(s.view_count||0)+1}).eq("id",s.id))}catch(s){console.error("Error fetching shared recipe:",s),v.error("Recipe not found or is no longer public")}finally{p(!1)}};if(u)return e.jsx(m,{children:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-pulse text-muted-foreground",children:"Loading recipe..."})})});if(!r)return e.jsx(m,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen gap-4",children:[e.jsx(o,{className:"w-16 h-16 text-muted-foreground"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Recipe Not Found"}),e.jsx("p",{className:"text-muted-foreground",children:"This recipe may have been removed or is no longer public."}),e.jsx(d,{onClick:()=>n("/"),children:"Go Home"})]})});const j=Array.isArray(r.ingredients)?r.ingredients:[],g=Array.isArray(r.instructions)?r.instructions:[],t=r.match_score||0;return e.jsx(m,{children:e.jsxs("div",{className:"container max-w-4xl mx-auto py-8 px-4",children:[e.jsxs(d,{variant:"ghost",onClick:()=>n("/"),className:"mb-6 gap-2",children:[e.jsx(k,{className:"w-4 h-4"}),"Back"]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx(o,{className:"w-8 h-8 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:r.name}),e.jsx("p",{className:"text-muted-foreground",children:"Shared from KAEVA"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[t>0&&e.jsxs(i,{variant:"outline",className:y("text-sm",t>=80?"bg-secondary/10 text-secondary border-secondary/20":t>=50?"bg-primary/10 text-primary border-primary/20":"bg-destructive/10 text-destructive border-destructive/20"),children:[e.jsx(A,{className:"w-3 h-3 mr-1"}),t,"% Match"]}),r.cooking_time&&e.jsxs(i,{variant:"outline",className:"gap-2",children:[e.jsx(w,{className:"w-4 h-4"}),r.cooking_time," min"]}),r.servings&&e.jsxs(i,{variant:"outline",className:"gap-2",children:[e.jsx(_,{className:"w-4 h-4"}),r.servings," servings"]}),r.difficulty&&e.jsx(i,{variant:"outline",className:"capitalize",children:r.difficulty}),r.estimated_calories&&e.jsxs(i,{variant:"outline",children:[r.estimated_calories," cal"]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Ingredients"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:j.map((s,a)=>e.jsx("div",{className:"flex items-center gap-3 p-3 rounded-lg border border-border bg-card/50",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-medium",children:s.item||s.name||"Unknown"}),(s.quantity||s.amount)&&e.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:[s.quantity||s.amount," ",s.unit||""]})]})},a))})]}),r.required_appliances&&r.required_appliances.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-3",children:"Required Appliances"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.required_appliances.map((s,a)=>e.jsx(i,{variant:"outline",className:"capitalize",children:s},a))})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Instructions"}),e.jsx("ol",{className:"space-y-4",children:g.map((s,a)=>e.jsxs("li",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-primary font-semibold",children:a+1}),e.jsx("p",{className:"flex-1 pt-1 text-foreground/90",children:s.step||s.instruction||s})]},a))})]}),e.jsxs("div",{className:"mt-12 p-6 rounded-xl border border-border bg-card/30 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Like this recipe? Get personalized recipe suggestions based on your pantry with KAEVA."}),e.jsxs(d,{onClick:()=>n("/auth"),size:"lg",className:"gap-2",children:[e.jsx(o,{className:"w-5 h-5"}),"Try KAEVA Free"]})]})]})})}export{G as default};
